---
title: "Eval"
author: "Sem"
date: "2025-05-23"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ggplot2)
library(RColorBrewer)
```

# Introduction

This .Rmd file is used to create nice plots for the report and presentation

# PHH

```{r}
df_phh <- data.frame(
  Algorithm = c("Eigengene", "Eigengene", "wDRW", "wDRW"),
  Outlier_Direction = c("Underquantification", "Overquantification", "Underquantification", "Overquantification"),
  density = c(0.030444465, 0.001257616, 0.028, 0.000676)
)
```

```{r}
# Zorg dat 'Below fit' onder 'Above fit' komt in stacking
df_phh$Outlier_Direction <- factor(df_phh$Outlier_Direction, levels = c("Overquantification", "Underquantification"))
```


```{r}
darkblue_palette <- c("Overquantification" = "#1f78b4",
                      "Underquantification" = "#0c2c54") 

# Plot met custom palette
ggplot(df_phh, aes(x = Algorithm, y = density, fill = Outlier_Direction)) +
  geom_bar(stat = "identity") +
  labs(y = "Outlier Density", x = "Scoring Algorithm", fill = "Outlier Direction") +
  ggtitle("Outlier density above and below binomial fit (wGRR vs scoring method) in PHH") +
  theme_minimal() +
  scale_fill_manual(values = darkblue_palette)
```

# RPTEC

```{r}
df_rptec <- data.frame(
  Algorithm = c("Eigengene", "Eigengene", "wDRW", "wDRW"),
  Outlier_Direction = c("Underquantification", "Overquantification", "Underquantification", "Overquantification"),
  density = c(0.11816872, 0.02527436, 0.0802, 0.0187)
)
```

```{r}
# Zorg dat 'Below fit' onder 'Above fit' komt in stacking
df_rptec$Outlier_Direction <- factor(df_rptec$Outlier_Direction, levels = c("Overquantification", "Underquantification"))

# Plot
ggplot(df_rptec, aes(x = Algorithm, y = density, fill = Outlier_Direction)) +
  geom_bar(stat = "identity") +
  labs(y = "Outlier Density", x = "Scoring Algorithm", fill = "Outlier Direction") +
  ggtitle("Outlier density above and below binomial fit (wGRR vs scoring method) in RPTEC") +
  theme_minimal() + scale_fill_brewer(palette = "Set2")
```
